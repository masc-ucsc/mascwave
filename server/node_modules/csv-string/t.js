const csv = require('.');
const fs = require('fs');
const { createStream } = csv;
const separator = ',';
const reader = fs.createReadStream('./i.csv', {
      highWaterMark: 5 
});
const parser = createStream({ separator });
const rows = [];
parser.on('data', row => {
  rows.push(row);
});
parser.on('end', () => {
  console.log('expected', csv.parse('1,2,"3,3",4\n1,2,3,4'));
  console.log('actual', rows);
});

reader.pipe(parser);


